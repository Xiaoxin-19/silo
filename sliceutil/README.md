# ğŸš€ SliceUtil æ€§èƒ½åŸºå‡†æµ‹è¯• (Benchmarks)


æœ¬æ–‡æ¡£è®°å½•äº† `sliceutil` åŒ…ä¸­æ ¸å¿ƒå‡½æ•°çš„æ€§èƒ½æµ‹è¯•ç»“æœã€‚æµ‹è¯•æ—¨åœ¨éªŒè¯ä¼˜åŒ–ç­–ç•¥ï¼ˆå¦‚é¢„åˆ†é…å†…å­˜ã€åŸåœ°ç®—æ³•ã€å¹¶å‘å¤„ç†ï¼‰çš„å®é™…æ•ˆæœã€‚

**æµ‹è¯•ç¯å¢ƒ**: Windows (amd64), AMD Ryzen 7 4800H (8C16T), Go 1.2x

### 1. Partition (åˆ†åŒº) æ€§èƒ½å¯¹æ¯”

æµ‹è¯•åœºæ™¯ï¼šå°† 1,000,000 ä¸ªæ•´æ•°æŒ‰å¥‡å¶æ€§åˆ†ä¸ºä¸¤ç»„ã€‚

| å®ç°æ–¹å¼ | è€—æ—¶/op | å†…å­˜/op | åˆ†é…æ¬¡æ•°/op | è¯„ä»· |
| :--- | :--- | :--- | :--- | :--- |
| **Partition (Two-Pass)** | **4.42 ms** | **8.0 MB** | **2** | âœ… **æ¨è**ã€‚é€šè¿‡ä¸¤æ¬¡éå†ï¼ˆä¸€æ¬¡è®¡æ•°ã€ä¸€æ¬¡å¡«å……ï¼‰ï¼Œå°†å†…å­˜åˆ†é…é™è‡³ç†è®ºæœ€å°å€¼ï¼Œä¸”ä¿æŒäº†å…ƒç´ é¡ºåºã€‚ |
| Naive Append | 9.48 ms | 42.2 MB | 70 | âŒ **ä½æ•ˆ**ã€‚ç”±äºåˆ‡ç‰‡åŠ¨æ€æ‰©å®¹ï¼ˆ`growslice`ï¼‰ï¼Œå¯¼è‡´ 5 å€çš„å†…å­˜æµªè´¹å’Œå¤§é‡çš„æ‹·è´å¼€é”€ã€‚ |
| **PartitionInPlace** | **1.72 ms** | **0 B** | **0** | ğŸš€ **æè‡´æ€§èƒ½**ã€‚é›¶åˆ†é…ï¼Œé€Ÿåº¦æœ€å¿«ã€‚ä½†ä¼šä¿®æ”¹åŸæ•°ç»„ä¸”ä¸ä¿è¯ç›¸å¯¹é¡ºåºã€‚ |
| GroupBy | 33.12 ms | 84.2 MB | 2119 | ğŸ¢ **æœ€æ…¢**ã€‚Map çš„å“ˆå¸Œè®¡ç®—å’Œæ¡¶åˆ†é…å¼€é”€å·¨å¤§ï¼Œä¸é€‚åˆç®€å•çš„äºŒåˆ†ç±»åœºæ™¯ã€‚ |

> **ç»“è®º**: `Partition` çš„ Two-Pass ä¼˜åŒ–éå¸¸æˆåŠŸï¼Œåœ¨ä¿æŒå‡½æ•°çº¯ç²¹æ€§çš„å‰æä¸‹ï¼Œæ€§èƒ½è¿œè¶…æ™®é€šå®ç°ã€‚

### 2. å¹¶å‘å¤„ç† (Parallel Map/Filter)

æµ‹è¯•åœºæ™¯ï¼šå¯¹ 10,000 ä¸ªå…ƒç´ æ‰§è¡Œé‡è®¡ç®—è´Ÿè½½ï¼ˆæ¨¡æ‹Ÿè€—æ—¶æ“ä½œï¼‰ï¼Œå¯¹æ¯”ä¸²è¡Œä¸å¹¶è¡Œï¼ˆ16 çº¿ç¨‹ï¼‰ã€‚

| åœºæ™¯ | ä¸²è¡Œè€—æ—¶ | å¹¶è¡Œè€—æ—¶ | åŠ é€Ÿæ¯” | è¯´æ˜ |
| :--- | :--- | :--- | :--- | :--- |
| **Filter (Heavy)** | 26.26 ms | 2.17 ms | **~12.1x** | å¹¶è¡Œè¿‡æ»¤ï¼Œåˆ©ç”¨å¤šæ ¸ä¼˜åŠ¿æ˜¾è‘—é™ä½å»¶è¿Ÿã€‚ |
| **Map (Heavy)** | 26.17 ms | 2.24 ms | **~11.7x** | å¹¶è¡Œæ˜ å°„ï¼ŒåŠ é€Ÿæ¯”æ¥è¿‘çº¿æ€§ã€‚ |

> **ç»“è®º**: åœ¨è®¡ç®—å¯†é›†å‹ä»»åŠ¡ä¸­ï¼Œ`TryParallelMap` å’Œ `TryParallelFilter` èƒ½å……åˆ†åˆ©ç”¨å¤šæ ¸ CPUï¼Œå¸¦æ¥ 10 å€ä»¥ä¸Šçš„æ€§èƒ½æå‡ã€‚

### 3. Flatten (æ‰å¹³åŒ–) ä¼˜åŒ–

æµ‹è¯•åœºæ™¯ï¼šå°† 1,000 ä¸ªå­åˆ‡ç‰‡ï¼ˆæ¯ä¸ªå« 1,000 ä¸ªå…ƒç´ ï¼‰åˆå¹¶ä¸ºä¸€ä¸ª 1,000,000 å…ƒç´ çš„å¤§åˆ‡ç‰‡ã€‚

| å®ç°æ–¹å¼ | è€—æ—¶/op | å†…å­˜/op | åˆ†é…æ¬¡æ•°/op |
| :--- | :--- | :--- | :--- |
| **Flatten (Pre-Alloc)** | **1.91 ms** | **8.0 MB** | **1** |
| Direct Append | 6.50 ms | 44.9 MB | 26 |

> **ç»“è®º**: é¢„å…ˆè®¡ç®—æ€»é•¿åº¦å¹¶ä¸€æ¬¡æ€§åˆ†é…å†…å­˜ï¼Œæ¯”ä¾èµ– `append` è‡ªåŠ¨æ‰©å®¹å¿« **3.4 å€**ï¼Œä¸”å†…å­˜å ç”¨å‡å°‘ **5.6 å€**ã€‚

---

### åŸå§‹æµ‹è¯•è¾“å‡º
```text
BenchmarkPartition_TwoPass-16           	     264	   4422705 ns/op	 8011779 B/op	       2 allocs/op
BenchmarkPartition_NaiveAppend-16       	     129	   9341716 ns/op	42166794 B/op	      70 allocs/op
BenchmarkPartition_InPlace-16           	     688	   1726426 ns/op	       0 B/op	       0 allocs/op
BenchmarkPartition_GroupBy-16           	      36	  32478603 ns/op	84152059 B/op	    2119 allocs/op
BenchmarkParallelFilter_HeavyWork/SerialFilter_Heavy-16         	      45	  26258567 ns/op	   40960 B/op	       1 allocs/op
BenchmarkParallelFilter_HeavyWork/ParallelFilter_Heavy-16       	     556	   2170071 ns/op	  125961 B/op	      61 allocs/op
BenchmarkParallelMap_HeavyWork/SerialMap_Heavy-16               	      43	  26171121 ns/op	   81920 B/op	       1 allocs/op
BenchmarkParallelMap_HeavyWork/ParallelMap_Heavy-16             	     583	   2239998 ns/op	   84287 B/op	      36 allocs/op
BenchmarkFlatten/PreAllocAndCopy-16                             	     654	   1868862 ns/op	 8003591 B/op	       1 allocs/op
BenchmarkFlatten/DirectAppend-16                                	     180	   6779273 ns/op	44900395 B/op	      26 allocs/op
```